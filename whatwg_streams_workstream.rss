<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>WHATWG Streams Workstream-relevant MDN issues</title>
        <link>https://dontcallmedom.github.io/mdn-issue-by-spec/whatwg_streams_workstream.rss</link>
        <description>Issue filed on MDN Web Docs related to pages attached to technologies developed by WHATWG Streams Workstream</description>
        <lastBuildDate>Tue, 05 Sep 2023 19:36:09 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[[streams] infinite loop in example code]]></title>
            <link>https://github.com/mdn/content/issues/28954</link>
            <guid>https://github.com/mdn/content/issues/28954</guid>
            <pubDate>Tue, 05 Sep 2023 19:36:09 GMT</pubDate>
            <content:encoded><![CDATA[<h3 dir="auto">MDN URL</h3>
<p dir="auto"><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader" rel="nofollow">https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader</a></p>
<h3 dir="auto">What specific section or headline is this issue about?</h3>
<p dir="auto">"Examples"</p>
<h3 dir="auto">What information was incorrect, unhelpful, or incomplete?</h3>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="while (offset &lt; buffer.byteLength) {
  // THIS LOOP IS INFINITE!
  // offset never changes because `readStream` is not async and
  // we do not `await` the result of `reader.read(...).then(...)`
  reader
    .read(...)
    .then(...);
}"><pre class="notranslate"><span class="pl-k">while</span> <span class="pl-kos">(</span><span class="pl-s1">offset</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">buffer</span><span class="pl-kos">.</span><span class="pl-c1">byteLength</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  <span class="pl-c">// THIS LOOP IS INFINITE!</span>
  <span class="pl-c">// offset never changes because `readStream` is not async and</span>
  <span class="pl-c">// we do not `await` the result of `reader.read(...).then(...)`</span>
  <span class="pl-s1">reader</span>
    <span class="pl-kos">.</span><span class="pl-en">read</span><span class="pl-kos">(</span>...<span class="pl-kos">)</span>
    <span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span>...<span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span></pre></div>
<p dir="auto">Also the loop will not terminate when the stream is <code class="notranslate">done</code>. It only terminates if the buffer runs out of room.</p>
<h3 dir="auto">What did you expect to see?</h3>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="async function readStream(reader) {
  ...
  while (offset &lt; buffer.byteLength) {
    await reader
      .read(...)
      .then(...);
  }
}

### Do you have any supporting links, references, or citations?

_No response_

### Do you have anything more you want to share?

_No response_

### MDN metadata

&lt;!-- Do not make changes below this line --&gt;
&lt;details&gt;
&lt;summary&gt;Page report details&lt;/summary&gt;

* Folder: `en-us/web/api/readablestreambyobreader`
* MDN URL: https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader
* GitHub URL: https://github.com/mdn/content/blob/main/files/en-us/web/api/readablestreambyobreader/index.md
* Last commit: https://github.com/mdn/content/commit/d41c5446d4ef257280fae9b78e2298ced8954a95
* Document last modified: 2023-05-09T20:58:09.000Z

&lt;/details&gt;"><pre class="notranslate"><span class="pl-k">async</span> <span class="pl-k">function</span> <span class="pl-en">readStream</span><span class="pl-kos">(</span><span class="pl-s1">reader</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
  ...
  <span class="pl-k">while</span> <span class="pl-kos">(</span><span class="pl-s1">offset</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">buffer</span><span class="pl-kos">.</span><span class="pl-c1">byteLength</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">await</span> <span class="pl-s1">reader</span>
      <span class="pl-kos">.</span><span class="pl-en">read</span><span class="pl-kos">(</span>...<span class="pl-kos">)</span>
      <span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span>...<span class="pl-s1"></span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span>
<span class="pl-kos">}</span>

### <span class="pl-v">Do</span> <span class="pl-s1">you</span> <span class="pl-s1">have</span> <span class="pl-s1">any</span> <span class="pl-s1">supporting</span> <span class="pl-s1">links</span><span class="pl-kos">,</span> <span class="pl-s1">references</span><span class="pl-kos">,</span> <span class="pl-s1">or</span> <span class="pl-s1">citations</span>?

<span class="pl-s1">_No</span> <span class="pl-s1">response_</span>

### <span class="pl-v">Do</span> <span class="pl-s1">you</span> <span class="pl-s1">have</span> <span class="pl-s1">anything</span> <span class="pl-s1">more</span> <span class="pl-s1">you</span> <span class="pl-s1">want</span> <span class="pl-s1">to</span> <span class="pl-s1">share</span>?

<span class="pl-s1">_No</span> <span class="pl-s1">response_</span>

### <span class="pl-c1">MDN</span> <span class="pl-s1">metadata</span>

<span class="pl-c1">&lt;</span><span class="pl-c1">!</span><span class="pl-c1">--</span> <span class="pl-v">Do</span> <span class="pl-s1">not</span> <span class="pl-s1">make</span> <span class="pl-s1">changes</span> <span class="pl-s1">below</span> <span class="pl-s1">this</span> <span class="pl-s1">line</span> <span class="pl-c1">--</span><span class="pl-c1">&gt;</span>
<span class="pl-c1">&lt;</span><span class="pl-ent">details</span><span class="pl-c1">&gt;</span>
<span class="pl-c1">&lt;</span><span class="pl-ent">summary</span><span class="pl-c1">&gt;</span>Page report details<span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">summary</span><span class="pl-c1">&gt;</span>

* Folder: `en-us/web/api/readablestreambyobreader`
* MDN URL: https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader
* GitHub URL: https://github.com/mdn/content/blob/main/files/en-us/web/api/readablestreambyobreader/index.md
* Last commit: https://github.com/mdn/content/commit/d41c5446d4ef257280fae9b78e2298ced8954a95
* Document last modified: 2023-05-09T20:58:09.000Z

<span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">details</span><span class="pl-c1">&gt;</span></pre></div>]]></content:encoded>
        </item>
    </channel>
</rss>